{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '50507982-c6a73d82cfbe0bce0234dfd9b';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page = 1, perPage = 40) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: perPage,\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n    throw error;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.getElementById('gallery');\nconst loader = document.getElementById('loader');\n\nlet lightbox;\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => `\n        <a class=\"photo-card\" href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          <div class=\"info\">\n            <p><b>Likes:</b> ${likes}</p>\n            <p><b>Views:</b> ${views}</p>\n            <p><b>Comments:</b> ${comments}</p>\n            <p><b>Downloads:</b> ${downloads}</p>\n          </div>\n        </a>\n      `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', { captionsData: 'alt', captionDelay: 250 });\n  } else {\n    lightbox.refresh();\n  }\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  loader.classList.add('hidden');\n}\n\n// import SimpleLightbox from 'simplelightbox';\n// import 'simplelightbox/dist/simple-lightbox.min.css';\n\n// let lightbox = new SimpleLightbox('.gallery a', {\n//   captionsData: 'alt',\n//   captionDelay: 250,\n// });\n\n// const gallery = document.querySelector('.gallery');\n// const loader = document.querySelector('.loader');\n\n// export function createGallery(images) {\n//   const markup = images\n//     .map(\n//       image => \n//       `<div class=\"photo-card\">\n//         <a href=\"${image.largeImageURL}\">\n//           <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n//         </a>\n//         <div class=\"info\">\n//           <p class=\"info-item\"><b>Likes</b><span>${image.likes}</span></p>\n//           <p class=\"info-item\"><b>Views</b><span>${image.views}</span></p>\n//           <p class=\"info-item\"><b>Comments</b><span>${image.comments}</span></p>\n//           <p class=\"info-item\"><b>Downloads</b><span>${image.downloads}</span></p>\n//         </div>\n//       </div>`\n//     )\n//     .join('');\n\n//   gallery.insertAdjacentHTML('beforeend', markup);\n//   lightbox.refresh();\n// }\n\n// export function clearGallery() {\n//   gallery.innerHTML = '';\n// }\n\n// export function showLoader() {\n//   loader.classList.remove('hidden');\n// }\n\n// export function hideLoader() {\n//   loader.classList.add('hidden');\n// }","import { getImagesByQuery } from './js/pixabay-api.js';\nimport { createGallery, clearGallery, showLoader, hideLoader } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n\nconst form = document.getElementById('search-form');\nconst guard = document.getElementById('guard');\n\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\nconst perPage = 40;\n\nform.addEventListener('submit', onSearch);\n\nasync function onSearch(event) {\n  event.preventDefault();\n  query = event.currentTarget.searchQuery.value.trim();\n  if (!query) return;\n\n  page = 1;\n  clearGallery();\n  observer.unobserve(guard);\n\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    totalHits = data.totalHits;\n\n    if (data.hits.length === 0) {\n      iziToast.info({ title: 'Info', message: 'No images found.', position: 'topRight' });\n      return;\n    }\n\n    createGallery(data.hits);\n    observer.observe(guard);\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: 'Failed to fetch images.', position: 'topRight' });\n  } finally {\n    hideLoader();\n  }\n}\n\nconst observerOptions = {\n  root: null,\n  rootMargin: '200px',\n  threshold: 1.0,\n};\n\nconst observer = new IntersectionObserver(onLoadMore, observerOptions);\n\nasync function onLoadMore(entries) {\n  for (const entry of entries) {\n    if (entry.isIntersecting) {\n      page++;\n      showLoader();\n\n      try {\n        const data = await getImagesByQuery(query, page);\n        createGallery(data.hits);\n\n        const loadedImages = document.querySelectorAll('.gallery a').length;\n        if (loadedImages >= totalHits) {\n          iziToast.info({ title: 'End', message: 'No more images.', position: 'topRight' });\n          observer.unobserve(guard);\n        }\n      } catch (error) {\n        iziToast.error({ title: 'Error', message: 'Loading more images failed.', position: 'topRight' });\n        observer.unobserve(guard);\n      } finally {\n        hideLoader();\n      }\n    }\n  }\n}\n\n// import { getImagesByQuery } from './js/pixabay-api';\n// import {\n//   createGallery,\n//   clearGallery,\n//   showLoader,\n//   hideLoader,\n// } from './js/render-functions';\n// import iziToast from 'izitoast';\n\n// const form = document.querySelector('.form');\n// const loadMoreBtn = document.querySelector('.load-more');\n\n// let searchQuery = '';\n// let currentPage = 1;\n// let totalHits = 0;\n\n// hideLoadMore();\n\n// form.addEventListener('submit', async e => {\n//   e.preventDefault();\n//   searchQuery = e.target.elements.searchQuery.value.trim();\n//   if (!searchQuery) return;\n\n//   clearGallery();\n//   hideLoadMore(); \n//   currentPage = 1;\n\n//   showLoader();\n\n//   try {\n//     const { hits, totalHits: total } = await getImagesByQuery(searchQuery, currentPage);\n//     totalHits = total;\n\n//     if (hits.length === 0) {\n//       iziToast.info({ message: 'No images found. Try another keyword!' });\n//       return;\n//     }\n\n//     createGallery(hits);\n\n//     if (totalHits > hits.length) {\n//       showLoadMore();\n//     }\n//   } catch (error) {\n//     iziToast.error({ message: 'Error fetching images' });\n//   } finally {\n//     hideLoader();\n//   }\n// });\n\n// loadMoreBtn.addEventListener('click', async () => {\n//   currentPage++;\n//   showLoader();\n//   hideLoadMore();\n\n//   try {\n//     const { hits } = await getImagesByQuery(searchQuery, currentPage);\n//     createGallery(hits);\n\n//     const loadedImages = currentPage * 40;\n//     if (loadedImages >= totalHits) {\n//       hideLoadMore();\n//     }\n//   } catch (error) {\n//     iziToast.error({ message: 'Error loading more images' });\n//   } finally {\n//     hideLoader();\n//   }\n// });\n\n// function showLoadMore() {\n//   loadMoreBtn.style.display='block';\n// }\n\n// function hideLoadMore() {\n//   loadMoreBtn.style.display='none'\n// }"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","perPage","params","axios","error","gallery","loader","lightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","clearGallery","showLoader","hideLoader","form","guard","totalHits","onSearch","event","observer","data","iziToast","observerOptions","onLoadMore","entries","entry"],"mappings":"owBAEA,MAAMA,EAAU,qCACVC,EAAW,2BAEV,eAAeC,EAAiBC,EAAOC,EAAO,EAAGC,EAAU,GAAI,CACpE,MAAMC,EAAS,CACb,IAAKN,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAUC,CACd,EAEE,GAAI,CAEF,OADiB,MAAME,EAAM,IAAIN,EAAU,CAAE,OAAAK,CAAM,CAAE,GACrC,IACjB,OAAQE,EAAO,CACd,MAAMA,CACP,CACH,CCnBA,MAAMC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAS,SAAS,eAAe,QAAQ,EAE/C,IAAIC,EAEG,SAASC,EAAcC,EAAQ,CACpC,MAAMC,EAASD,EACZ,IACC,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA,sCAC9CL,CAAa;AAAA,sBAC7BD,CAAY,UAAUE,CAAI;AAAA;AAAA,+BAEjBC,CAAK;AAAA,+BACLC,CAAK;AAAA,kCACFC,CAAQ;AAAA,mCACPC,CAAS;AAAA;AAAA;AAAA,OAIvC,EACA,KAAK,EAAE,EAEVZ,EAAQ,mBAAmB,YAAaK,CAAM,EAEzCH,EAGHA,EAAS,QAAO,EAFhBA,EAAW,IAAIW,EAAe,aAAc,CAAE,aAAc,MAAO,aAAc,GAAG,CAAE,CAI1F,CAEO,SAASC,GAAe,CAC7Bd,EAAQ,UAAY,EACtB,CAEO,SAASe,GAAa,CAC3Bd,EAAO,UAAU,OAAO,QAAQ,CAClC,CAEO,SAASe,GAAa,CAC3Bf,EAAO,UAAU,IAAI,QAAQ,CAC/B,CCtCA,MAAMgB,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAQ,SAAS,eAAe,OAAO,EAE7C,IAAIxB,EAAQ,GACRC,EAAO,EACPwB,EAAY,EAGhBF,EAAK,iBAAiB,SAAUG,CAAQ,EAExC,eAAeA,EAASC,EAAO,CAG7B,GAFAA,EAAM,eAAc,EACpB3B,EAAQ2B,EAAM,cAAc,YAAY,MAAM,KAAI,EAC9C,EAAC3B,EAEL,CAAAC,EAAO,EACPmB,IACAQ,EAAS,UAAUJ,CAAK,EAExBH,IAEA,GAAI,CACF,MAAMQ,EAAO,MAAM9B,EAAiBC,EAAOC,CAAI,EAG/C,GAFAwB,EAAYI,EAAK,UAEbA,EAAK,KAAK,SAAW,EAAG,CAC1BC,EAAS,KAAK,CAAE,MAAO,OAAQ,QAAS,mBAAoB,SAAU,UAAU,CAAE,EAClF,MACD,CAEDrB,EAAcoB,EAAK,IAAI,EACvBD,EAAS,QAAQJ,CAAK,CACvB,MAAe,CACdM,EAAS,MAAM,CAAE,MAAO,QAAS,QAAS,0BAA2B,SAAU,UAAU,CAAE,CAC/F,QAAY,CACRR,GACD,EACH,CAEA,MAAMS,EAAkB,CACtB,KAAM,KACN,WAAY,QACZ,UAAW,CACb,EAEMH,EAAW,IAAI,qBAAqBI,EAAYD,CAAe,EAErE,eAAeC,EAAWC,EAAS,CACjC,UAAWC,KAASD,EAClB,GAAIC,EAAM,eAAgB,CACxBjC,IACAoB,IAEA,GAAI,CACF,MAAMQ,EAAO,MAAM9B,EAAiBC,EAAOC,CAAI,EAC/CQ,EAAcoB,EAAK,IAAI,EAEF,SAAS,iBAAiB,YAAY,EAAE,QACzCJ,IAClBK,EAAS,KAAK,CAAE,MAAO,MAAO,QAAS,kBAAmB,SAAU,UAAU,CAAE,EAChFF,EAAS,UAAUJ,CAAK,EAE3B,MAAe,CACdM,EAAS,MAAM,CAAE,MAAO,QAAS,QAAS,8BAA+B,SAAU,UAAU,CAAE,EAC/FF,EAAS,UAAUJ,CAAK,CAChC,QAAgB,CACRF,GACD,CACF,CAEL"}